<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è¯æ±‡äº¤äº’è®°å¿†(ç†ŠçŒ«æè‹±è¯­)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: 'Noto Sans SC', sans-serif; background: #f0f9ff; }
    .tab-active { @apply bg-blue-600 text-white; }
    .tab-inactive { @apply bg-gray-200 text-gray-700 hover:bg-gray-300; }
    .upload-btn { @apply bg-gradient-to-r from-green-400 to-blue-500 text-white px-6 py-3 rounded-full shadow-lg hover:opacity-90 transition; }
    .flip-card { width: 280px; height: 180px; perspective: 1000px; }
    .flip-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
    .flip-card.flipped .flip-inner { transform: rotateY(180deg); }
    .flip-front, .flip-back {
      position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
      display: flex; align-items: center; justify-content: center;
      border-radius: 1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); background: white;
      padding: 0.5rem;
    }
    .flip-front p {
      @apply px-4 text-left leading-relaxed break-words;
    }
    .flip-back { transform: rotateY(180deg); }
    .speaker-btn { position: absolute; top: 8px; right: 8px; font-size: 1.25rem; color: #555; }
    .multi-option { @apply w-full flex items-center justify-center text-center font-bold rounded-lg p-4 cursor-pointer transition; background: #FED7AA; }
    .multi-option:hover { background: #FDBA74; }
    .match-card { @apply flex items-center justify-center rounded-lg cursor-pointer transition; width: 100%; height: 60px; }
    .match-card-word { background: #A5B4FC; }
    .match-card-def { background: #86EFAC; }
    .selected { @apply opacity-50; }
    .nav-btn { @apply bg-blue-500 text-white rounded-full px-4 py-2 hover:bg-blue-600 transition; }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <header class="bg-white shadow p-4">
    <h1 class="text-center text-2xl font-bold text-blue-700">è¯æ±‡äº¤äº’è®°å¿†(ç†ŠçŒ«æè‹±è¯­)</h1>
  </header>

  <!-- ä¸Šä¼ åŒº + ç¤ºä¾‹ -->
  <div id="upload-area" class="flex-1 flex flex-col justify-center items-center mx-8 border-4 border-dashed border-gray-300 rounded-lg p-8 space-y-6"
       ondragover="event.preventDefault()" ondrop="event.preventDefault(); handleFile(event.dataTransfer.files[0]);">
    <p class="text-lg text-gray-600">æ‹–æ‹½æˆ–é‡Šæ”¾ Excel æ–‡ä»¶åˆ°æ­¤ï¼Œæˆ– ç‚¹å‡» ä¸‹æ–¹æŒ‰é’® é€‰æ‹© æ–‡ä»¶</p>
    <button id="file-btn" class="upload-btn">é€‰æ‹© Excel æ–‡ä»¶</button>
    <input type="file" id="file-input" accept=".xlsx" class="hidden" />

    <!-- ç¤ºä¾‹è¡¨æ ¼ -->
    <table class="table-auto border-collapse border border-gray-400 w-full max-w-md">
      <thead>
        <tr class="bg-gray-100">
          <th class="border border-gray-300 p-2">åºå·</th>
          <th class="border border-gray-300 p-2">å•è¯</th>
          <th class="border border-gray-300 p-2">éŸ³æ ‡</th>
          <th class="border border-gray-300 p-2">è¯æ€§è¯ä¹‰</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="border border-gray-300 p-2 text-center">1</td>
          <td class="border border-gray-300 p-2 text-center">apple</td>
          <td class="border border-gray-300 p-2 text-center">/ËˆÃ¦p.É™l/</td>
          <td class="border border-gray-300 p-2">n. è‹¹æœ</td>
        </tr>
        <tr>
          <td class="border border-gray-300 p-2 text-center">2</td>
          <td class="border border-gray-300 p-2 text-center">book</td>
          <td class="border border-gray-300 p-2 text-center">/bÊŠk/</td>
          <td class="border border-gray-300 p-2">n. ä¹¦</td>
        </tr>
        <tr>
          <td class="border border-gray-300 p-2 text-sm text-gray-600" colspan="4">
            è”ç³»å¾®ä¿¡ lgb13787746436ï¼ŒQQï¼š516351020ï¼Œè´­ä¹°3000æ–°è¯¾æ ‡è¯æ±‡ã€è¯‘æ—é«˜ä¸­è‹±è¯­è¯æ±‡ã€äººæ•™ç‰ˆé«˜ä¸­è‹±è¯­è¯æ±‡ Excel æ–‡ä»¶
          </td>
        </tr>
      </tbody>
    </table>

    <div class="text-sm text-gray-700">ä½¿ç”¨æ•™ç¨‹ï¼š</div>
    <img src="ä½¿ç”¨æ•™ç¨‹.jpg" alt="ä½¿ç”¨æ•™ç¨‹" class="w-48 h-48 object-contain" />
  </div>

  <!-- ä¸»ç•Œé¢ -->
  <div id="main" class="hidden flex-1 flex flex-col mx-8 my-4">
    <div class="flex justify-center space-x-4 mb-6">
      <button data-mode="flash" class="tab-inactive px-5 py-2 rounded-full">ç¿»ç¿»çœ‹</button>
      <button data-mode="multi" class="tab-inactive px-5 py-2 rounded-full">é€‰é€‰çœ‹</button>
      <button data-mode="match" class="tab-inactive px-5 py-2 rounded-full">æ¶ˆæ¶ˆçœ‹</button>
    </div>
    <div id="content" class="flex-1">
      <!-- ç¿»ç¿»çœ‹ -->
      <div id="flash" class="mode hidden flex flex-col items-center space-y-4 overflow-y-auto">
        <div id="flash-list" class="flex flex-col items-center space-y-4 pb-8"></div>
        <div class="flex justify-center items-center mt-4 space-x-6">
          <button id="prev-btn-flash" class="nav-btn">ä¸Šä¸€ç»„</button>
          <span class="text-gray-700">ç¬¬ <span id="grp-num-flash">1</span> / <span id="grp-total-flash">0</span> ç»„</span>
          <button id="next-btn-flash" class="nav-btn">ä¸‹ä¸€ç»„</button>
        </div>
      </div>
      <!-- é€‰é€‰çœ‹ -->
      <div id="multi" class="mode hidden flex flex-col items-center">
        <div class="mb-4">
          <button id="mode-eng2chn" class="tab-inactive px-4 py-2 rounded-full mr-2">è‹±è¯‘ä¸­</button>
          <button id="mode-chn2eng" class="tab-inactive px-4 py-2 rounded-full">ä¸­è¯‘è‹±</button>
        </div>
        <div id="multi-question" class="text-xl font-bold text-blue-600 mb-4 text-center"></div>
        <div id="multi-options" class="w-full max-w-md space-y-3"></div>
        <div class="flex justify-center items-center mt-4 space-x-6">
          <button id="prev-btn-multi" class="nav-btn">ä¸Šä¸€ç»„</button>
          <span class="text-gray-700">ç¬¬ <span id="grp-num-multi">1</span> / <span id="grp-total-multi">0</span> ç»„</span>
          <button id="next-btn-multi" class="nav-btn">ä¸‹ä¸€ç»„</button>
        </div>
      </div>
      <!-- æ¶ˆæ¶ˆçœ‹ -->
      <div id="match" class="mode hidden flex flex-col items-center">
        <div id="match-grid" class="grid grid-cols-3 gap-4 max-w-lg w-full mb-4"></div>
        <div id="match-grid-ch" class="grid grid-cols-3 gap-4 max-w-lg w-full mb-4"></div>
        <div class="flex justify-center items-center space-x-6">
          <button id="prev-btn-match" class="nav-btn">ä¸Šä¸€ç»„</button>
          <span class="text-gray-700">ç¬¬ <span id="grp-num-match">1</span> / <span id="grp-total-match">0</span> ç»„</span>
          <button id="next-btn-match" class="nav-btn">ä¸‹ä¸€ç»„</button>
        </div>
      </div>
    </div>
  </div>
  <audio id="audio-correct" src="å£°æ•ˆ/rightvoice.mp3"></audio>
  <audio id="audio-wrong" src="å£°æ•ˆ/wrongvoice.mp3"></audio>
<script>
  let groups = [], curGroup = 0, selectedCell = null, mcMode = 'eng2chn';
  document.querySelectorAll('[data-mode]').forEach(btn => btn.addEventListener('click', () => {
    document.querySelectorAll('.mode').forEach(m => m.classList.add('hidden'));
    document.getElementById(btn.dataset.mode).classList.remove('hidden');
    document.querySelectorAll('[data-mode]').forEach(b => b.classList.toggle('tab-active', b === btn));
    renderGroup(btn.dataset.mode);
  }));
  document.getElementById('mode-eng2chn').onclick = () => setMcMode('eng2chn');
  document.getElementById('mode-chn2eng').onclick = () => setMcMode('chn2eng');
  function setMcMode(mode) { mcMode = mode; document.getElementById('mode-eng2chn').classList.toggle('tab-active', mode === 'eng2chn'); document.getElementById('mode-chn2eng').classList.toggle('tab-active', mode === 'chn2eng'); renderMulti(groups[curGroup]); }
  document.getElementById('file-btn').onclick = () => document.getElementById('file-input').click();
  document.getElementById('file-input').onchange = e => handleFile(e.target.files[0]);
  function handleFile(file) {
    const base = file.name.replace(/\.xlsx$/i, '');
    document.title = base + 'äº¤äº’è®°å¿†(ç†ŠçŒ«æè‹±è¯­)';
    document.querySelector('header h1').textContent = base + 'äº¤äº’è®°å¿†(ç†ŠçŒ«æè‹±è¯­)';
    const reader = new FileReader();
    reader.onload = e => {
      const wb = XLSX.read(e.target.result, { type: 'array' });
      const data = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]], { header: ['åºå·','å•è¯','éŸ³æ ‡','è¯æ€§','è¯ä¹‰'], range: 1 });
      for (let i = 0; i < data.length; i += 50) groups.push(data.slice(i, i + 50));
      ['flash','multi','match'].forEach(m => document.getElementById(`grp-total-${m}`).innerText = groups.length);
      document.getElementById('upload-area').remove();
      document.getElementById('main').classList.remove('hidden');
      document.querySelector('[data-mode]').click();
      setMcMode('eng2chn');
    };
    reader.readAsArrayBuffer(file);
  }
  ['flash','multi','match'].forEach(m => { document.getElementById(`prev-btn-${m}`).onclick = () => { if (curGroup > 0) curGroup--; renderGroup(m); }; document.getElementById(`next-btn-${m}`).onclick = () => { if (curGroup < groups.length - 1) curGroup++; renderGroup(m); }; });
  function renderGroup(mode) { document.getElementById(`grp-num-${mode}`).innerText = curGroup + 1; const grp = groups[curGroup] || []; if (mode === 'flash') renderFlashGroup(grp); if (mode === 'multi') renderMulti(grp); if (mode === 'match') renderMatch(grp); }
  function renderFlashGroup(grp) { const list=document.getElementById('flash-list'); list.innerHTML=''; grp.forEach(item=>{ const container=document.createElement('div'); container.className='flip-card'; const inner=document.createElement('div'); inner.className='flip-inner'; const front=document.createElement('div'); front.className='flip-front'; front.innerHTML=`<p>${item.è¯æ€§||''}${item.è¯ä¹‰? ' '+item.è¯ä¹‰:''}</p>`; const back=document.createElement('div'); back.className='flip-back relative'; back.innerHTML=`<button class="speaker-btn">ğŸ”Š</button><div class="flex flex-col items-center justify-center h-full"><p class="text-xl font-bold">${item.å•è¯||''}</p><p class="text-sm text-green-600 mt-1">${item.éŸ³æ ‡||''}</p></div>`; inner.append(front,back); container.appendChild(inner); container.onclick=()=>container.classList.toggle('flipped'); back.querySelector('.speaker-btn').addEventListener('click',e=>{e.stopPropagation();playYoudao(item.å•è¯||'');}); list.appendChild(container); }); }
  function renderMulti(grp) { const qDiv=document.getElementById('multi-question'), opts=document.getElementById('multi-options'); opts.innerHTML=''; const item=grp[Math.floor(Math.random()*grp.length)]||{}; if(mcMode==='eng2chn'){ qDiv.innerText=item.å•è¯||''; const choices=[item]; while(choices.length<3){ const c=grp[Math.floor(Math.random()*grp.length)]; if(!choices.includes(c))choices.push(c);} shuffle(choices).forEach(opt=>{ const btn=document.createElement('div'); btn.className='multi-option'; btn.innerText=`${opt.è¯æ€§||''}${opt.è¯ä¹‰? ' '+opt.è¯ä¹‰:''}`; btn.onclick=()=>{playSound(opt===item);renderMulti(grp);}; opts.appendChild(btn); }); }else{ qDiv.innerText=`${item.è¯æ€§||''}${item.è¯ä¹‰? ' '+item.è¯ä¹‰:''}`; const choices=[item]; while(choices.length<3){ const c=grp[Math.floor(Math.random()*grp.length)]; if(!choices.includes(c))choices.push(c);} shuffle(choices).forEach(opt=>{ const btn=document.createElement('div'); btn.className='multi-option'; btn.innerText=opt.å•è¯||''; btn.onclick=()=>{playSound(opt===item);renderMulti(grp);}; opts.appendChild(btn); }); } }
  function renderMatch(grp) { const topGrid=document.getElementById('match-grid'), botGrid=document.getElementById('match-grid-ch'); topGrid.innerHTML=''; botGrid.innerHTML=''; selectedCell=null; const sel=shuffle(grp.slice()).slice(0,3), defs=shuffle(sel.slice()); sel.forEach(item=>{ const d=document.createElement('div'); d.className='match-card match-card-word flex items-center justify-center'; d.innerText=item.å•è¯||''; d.dataset.key=(item.è¯æ€§||'')+'_'+(item.è¯ä¹‰||''); d.onclick=()=>handleMatchClick(d); topGrid.appendChild(d); }); defs.forEach(item=>{ const d=document.createElement('div'); d.className='match-card match-card-def flex items-center justify-center'; d.innerText=(item.è¯æ€§||'')+' '+(item.è¯ä¹‰||''); d.dataset.key=(item.è¯æ€§||'')+'_'+(item.è¯ä¹‰||''); d.onclick=()=>handleMatchClick(d); botGrid.appendChild(d); }); }
  function handleMatchClick(el){ if(!selectedCell){ selectedCell=el;el.classList.add('selected'); }else if(el!==selectedCell){ if(el.dataset.key===selectedCell.dataset.key){ selectedCell.remove();el.remove();playSound(true);}else{selectedCell.classList.remove('selected');playSound(false);} selectedCell=null;const topGrid=document.getElementById('match-grid'),botGrid=document.getElementById('match-grid-ch'); if(topGrid.children.length===0 && botGrid.children.length===0){ if(curGroup<groups.length-1)curGroup++; renderMatch(groups[curGroup]); } } }
  function shuffle(arr){ for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr; }
  function playSound(ok){document.getElementById(ok?'audio-correct':'audio-wrong').play();}
  function playYoudao(word){if(!word)return;new Audio(`https://dict.youdao.com/dictvoice?audio=${encodeURIComponent(word)}&type=1`).play();}
</script>
</body>
</html>
